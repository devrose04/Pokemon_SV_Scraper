# Pokemon SV Construction Articles Uploader

This project scrapes Pokemon SV trainer construction articles (構築記事) from Season 27 and uploads the data to Google Sheets. It provides a user-friendly GUI for both scraping and uploading data.

## Project Structure

```
.
├── pokemon_sv_uploader.py  # Main GUI application
├── pokemon_scraper.py      # Script for scraping Pokemon SV construction articles
├── sheets_uploader.py      # Script for uploading data to Google Sheets
├── build_exe.py            # Script to build the executable
├── run.bat                 # Batch file to run the GUI application
├── build.bat               # Batch file to build the executable
├── requirements.txt        # Python dependencies
├── credentials.json        # Google Sheets API credentials
├── sample_trainer_data.json # Sample data for testing
└── pokemon_icon.ico        # Application icon

Generated files:
├── trainer_data.json       # Scraped Pokemon trainer data (generated by scraper)
├── dist/                   # Build output directory (generated by PyInstaller)
└── build/                  # Build temporary directory (generated by PyInstaller)
```

## Features

1. User-friendly GUI with tabs for scraping and uploading
2. Scrapes trainer data from construction articles (構築記事) on sv.pokedb.tokyo:
   - Season 27 trainer rankings
   - Team compositions
   - Pokemon details (moves, abilities, items, etc.)
   - Links to the original construction articles
3. Uploads data to Google Sheets
4. Provides a user-friendly executable
5. Error handling with popup messages
6. Progress tracking and periodic saving
7. Data preview functionality

## Prerequisites

1. Python 3.8 or later
2. Google Sheets API credentials (credentials.json)
3. A Google Sheet with the name "BaBa_kohsi様_入力シート"
4. Internet connection for scraping data

## Setup

### Development Mode
1. Clone this repository
2. Place your Google Sheets API credentials in `credentials.json`
3. Run `run.bat` to start the GUI application

### Building Executable

1. Run `build.bat` to build the executable
2. The executable will be created in the `dist` directory as `Pokemon_SV_Uploader.exe`
3. Copy `credentials.json` to the same directory as the executable

## Data Format

The trainer_data.json follows this format:

```json
[
  {
    "rank": 1,
    "rating": 2000,
    "trainer_name": "Example Trainer",
    "article_url": "https://example.com/article",
    "pokemon": [
      {
        "name": "Pokemon1",
        "item": "Item1",
        "nature": "Nature1",
        "ability": "Ability1",
        "tera_type": "Type1",
        "moves": ["Move1", "Move2", "Move3", "Move4"],
        "evs": {
          "H": 0,
          "A": 0,
          "B": 0,
          "C": 0,
          "D": 0,
          "S": 0
        }
      }
      // ... up to 6 Pokemon
    ]
  }
  // ... more trainers
]
```

## Using the Application

### GUI Application
1. Run the application using `run.bat` or by double-clicking the executable
2. The application has two tabs:
   - **Scraper**: Configure and run the scraper to collect trainer data
   - **Uploader**: Upload the collected data to Google Sheets

### Scraper Tab
1. Configure the scraping parameters:
   - Season: The season number to scrape (default: 27)
   - Rule: The rule type (default: 0)
   - Party: The party type (default: 1)
   - Max Trainers: Maximum number of trainers to scrape (default: 50)
   - Output File: Where to save the scraped data (default: trainer_data.json)
2. Click "Start Scraping" to begin the scraping process
3. The log window will show progress and any errors
4. After completion, the application will automatically switch to the Uploader tab

### Uploader Tab
1. Configure the upload parameters:
   - JSON Data File: The file containing the trainer data
   - Credentials File: Your Google Sheets API credentials
   - Spreadsheet Name: The name of your Google Sheet
   - Spreadsheet ID: The ID of your Google Sheet
2. Click "Preview Data" to see a summary of the data to be uploaded
3. Click "Upload to Sheets" to upload the data to Google Sheets

## Troubleshooting

1. Ensure `credentials.json` is in the same directory as the executable
2. Check that your Google Sheets credentials are valid and have the necessary permissions
3. Verify your internet connection is stable
4. Make sure the target Google Sheet exists and is accessible
5. If the scraping process fails, try running it again (the website might be temporarily unavailable)
6. For any persistent issues, check the error messages displayed in the application

## Notes

- The scraper specifically targets trainers who have published construction articles (構築記事) for Season 27
- Approximately 150 construction articles are available for Season 27
- The data includes trainer name, rank, rating, article URL, and details for up to 6 Pokemon per trainer
- Pokemon details include name, ability, item, Tera type, nature, moves, and effort values 